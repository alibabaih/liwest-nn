(function(){var v=0,q=[],o={},s={},A={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},p=/[<>&\"\']/g,z,y=window.setTimeout,x={},w;function t(){this.returnValue=false;}function r(){this.cancelBubble=true;}(function(e){var d=e.split(/,/),c,a,b;for(c=0;c<d.length;c+=2){b=d[c+1].split(/ /);for(a=0;a<b.length;a++){s[b[a]]=d[c];}}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats,docx pptx xlsx,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,text/csv,csv,text/plain,asc txt text diff log,application/octet-stream,exe");var u={VERSION:"1.5.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:s,ua:(function(){var b=navigator,c=b.userAgent,a=b.vendor,e,f,d;e=/WebKit/.test(c);d=e&&a.indexOf("Apple")!==-1;f=window.opera&&window.opera.buildNumber;return{windows:navigator.platform.indexOf("Win")!==-1,ie:!e&&!f&&(/MSIE/gi).test(c)&&(/Explorer/gi).test(b.appName),webkit:e,gecko:!e&&/Gecko/.test(c),safari:d,opera:!!f};}()),extend:function(a){u.each(arguments,function(c,b){if(b>0){u.each(c,function(d,e){a[e]=d;});}});return a;},cleanName:function(c){var b,a;a=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<a.length;b+=2){c=c.replace(a[b],a[b+1]);}c=c.replace(/\s+/g,"_");c=c.replace(/[^a-z0-9_\-\.]+/gi,"");return c;},addRuntime:function(b,a){a.name=b;q[b]=a;q.push(a);return a;},guid:function(){var b=new Date().getTime().toString(32),a;for(a=0;a<5;a++){b+=Math.floor(Math.random()*65535).toString(32);}return(u.guidPrefix||"p")+b+(v++).toString(32);},buildUrl:function(b,c){var a="";u.each(c,function(d,e){a+=(a?"&":"")+encodeURIComponent(e)+"="+encodeURIComponent(d);});if(a){b+=(b.indexOf("?")>0?"&":"?")+a;}return b;},each:function(b,a){var c,d,e;if(b){c=b.length;if(c===z){for(d in b){if(b.hasOwnProperty(d)){if(a(b[d],d)===false){return;}}}}else{for(e=0;e<c;e++){if(a(b[e],e)===false){return;}}}}},formatSize:function(a){if(a===z||/\D/.test(a)){return u.translate("N/A");}if(a>1073741824){return Math.round(a/1073741824,1)+" GB";}if(a>1048576){return Math.round(a/1048576,1)+" MB";}if(a>1024){return Math.round(a/1024,1)+" KB";}return a+" b";},getPos:function(c,h){var g=0,j=0,e,f=document,b,a;c=c;h=h||f.body;function d(n){var k,E,m=0,l=0;if(n){E=n.getBoundingClientRect();k=f.compatMode==="CSS1Compat"?f.documentElement:f.body;m=E.left+k.scrollLeft;l=E.top+k.scrollTop;}return{x:m,y:l};}if(c&&c.getBoundingClientRect&&(navigator.userAgent.indexOf("MSIE")>0&&f.documentMode!==8)){b=d(c);a=d(h);return{x:b.x-a.x,y:b.y-a.y};}e=c;while(e&&e!=h&&e.nodeType){g+=e.offsetLeft||0;j+=e.offsetTop||0;e=e.offsetParent;}e=c.parentNode;while(e&&e!=h&&e.nodeType){g-=e.scrollLeft||0;j-=e.scrollTop||0;e=e.parentNode;}return{x:g,y:j};},getSize:function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight};},parseSize:function(b){var a;if(typeof(b)=="string"){b=/^([0-9]+)([mgk]?)$/.exec(b.toLowerCase().replace(/[^0-9mkg]/g,""));a=b[2];b=+b[1];if(a=="g"){b*=1073741824;}if(a=="m"){b*=1048576;}if(a=="k"){b*=1024;}}return b;},xmlEncode:function(a){return a?(""+a).replace(p,function(b){return A[b]?"&"+A[b]+";":b;}):a;},toArray:function(a){var b,c=[];for(b=0;b<a.length;b++){c[b]=a[b];}return c;},addI18n:function(a){return u.extend(o,a);},translate:function(a){return o[a]||a;},isEmptyObj:function(b){if(b===z){return true;}for(var a in b){return false;}return true;},hasClass:function(a,b){var c;if(a.className==""){return false;}c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");return c.test(a.className);},addClass:function(a,b){if(!u.hasClass(a,b)){a.className=a.className==""?b:a.className.replace(/\s+$/,"")+" "+b;}},removeClass:function(a,b){var c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");a.className=a.className.replace(c,function(e,f,d){return f===" "&&d===" "?" ":"";});},getStyle:function(a,b){if(a.currentStyle){return a.currentStyle[b];}else{if(window.getComputedStyle){return window.getComputedStyle(a,null)[b];}}},addEvent:function(b,g,a){var c,d,e,f;f=arguments[3];g=g.toLowerCase();if(w===z){w="Plupload_"+u.guid();}if(b.addEventListener){c=a;b.addEventListener(g,c,false);}else{if(b.attachEvent){c=function(){var h=window.event;if(!h.target){h.target=h.srcElement;}h.preventDefault=t;h.stopPropagation=r;a(h);};b.attachEvent("on"+g,c);}}if(b[w]===z){b[w]=u.guid();}if(!x.hasOwnProperty(b[w])){x[b[w]]={};}d=x[b[w]];if(!d.hasOwnProperty(g)){d[g]=[];}d[g].push({func:c,orig:a,key:f});},removeEvent:function(b,g){var d,a,e;if(typeof(arguments[2])=="function"){a=arguments[2];}else{e=arguments[2];}g=g.toLowerCase();if(b[w]&&x[b[w]]&&x[b[w]][g]){d=x[b[w]][g];}else{return;}for(var f=d.length-1;f>=0;f--){if(d[f].key===e||d[f].orig===a){if(b.detachEvent){b.detachEvent("on"+g,d[f].func);}else{if(b.removeEventListener){b.removeEventListener(g,d[f].func,false);}}d[f].orig=null;d[f].func=null;d.splice(f,1);if(a!==z){break;}}}if(!d.length){delete x[b[w]][g];}if(u.isEmptyObj(x[b[w]])){delete x[b[w]];try{delete b[w];}catch(c){b[w]=z;}}},removeAllEvents:function(a){var b=arguments[1];if(a[w]===z||!a[w]){return;}u.each(x[a[w]],function(c,d){u.removeEvent(a,d,b);});}};u.Uploader=function(d){var f={},a,b=[],e;a=new u.QueueProgress();d=u.extend({chunk_size:0,multipart:true,multi_selection:true,file_data_name:"file",filters:[]},d);function c(){var j,h=0,k;if(this.state==u.STARTED){for(k=0;k<b.length;k++){if(!j&&b[k].status==u.QUEUED){j=b[k];j.status=u.UPLOADING;if(this.trigger("BeforeUpload",j)){this.trigger("UploadFile",j);}}else{h++;}}if(h==b.length){this.stop();this.trigger("UploadComplete",b);}}}function g(){var h,j;a.reset();for(h=0;h<b.length;h++){j=b[h];if(j.size!==z){a.size+=j.size;a.loaded+=j.loaded;}else{a.size=z;}if(j.status==u.DONE){a.uploaded++;}else{if(j.status==u.FAILED){a.failed++;}else{a.queued++;}}}if(a.size===z){a.percent=b.length>0?Math.ceil(a.uploaded/b.length*100):0;}else{a.bytesPerSec=Math.ceil(a.loaded/((+new Date()-e||1)/1000));a.percent=a.size>0?Math.ceil(a.loaded/a.size*100):0;}}u.extend(this,{state:u.STOPPED,runtime:"",features:{},files:b,settings:d,total:a,id:u.guid(),init:function(){var j=this,C,h,k,m=0,n;if(typeof(d.preinit)=="function"){d.preinit(j);}else{u.each(d.preinit,function(B,E){j.bind(E,B);});}d.page_url=d.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");if(!/^(\w+:\/\/|\/)/.test(d.url)){d.url=d.page_url+d.url;}d.chunk_size=u.parseSize(d.chunk_size);d.max_file_size=u.parseSize(d.max_file_size);j.bind("FilesAdded",function(O,L){var M,N,J=0,B,K=d.filters;if(K&&K.length){B=[];u.each(K,function(D){u.each(D.extensions.split(/,/),function(E){if(/^\s*\*\s*$/.test(E)){B.push("\\.*");}else{B.push("\\."+E.replace(new RegExp("["+("/^$.*+?|()[]{}\\".replace(/./g,"\\$&"))+"]","g"),"\\$&"));}});});B=new RegExp(B.join("|")+"$","i");}for(M=0;M<L.length;M++){N=L[M];N.loaded=0;N.percent=0;N.status=u.QUEUED;if(B&&!B.test(N.name)){O.trigger("Error",{code:u.FILE_EXTENSION_ERROR,message:u.translate("File extension error."),file:N});continue;}if(N.size!==z&&N.size>d.max_file_size){O.trigger("Error",{code:u.FILE_SIZE_ERROR,message:u.translate("File size error."),file:N});continue;}b.push(N);J++;}if(J){y(function(){j.trigger("QueueChanged");j.refresh();},1);}else{return false;}});if(d.unique_names){j.bind("UploadFile",function(I,H){var B=H.name.match(/\.([^.]+)$/),G="tmp";if(B){G=B[1];}H.target_name=H.id+"."+G;});}j.bind("UploadProgress",function(E,B){B.percent=B.size>0?Math.ceil(B.loaded/B.size*100):100;g();});j.bind("StateChanged",function(B){if(B.state==u.STARTED){e=(+new Date());}else{if(B.state==u.STOPPED){for(C=B.files.length-1;C>=0;C--){if(B.files[C].status==u.UPLOADING){B.files[C].status=u.QUEUED;g();}}}}});j.bind("QueueChanged",g);j.bind("Error",function(E,B){if(B.file){B.file.status=u.FAILED;g();if(E.state==u.STARTED){y(function(){c.call(j);},1);}}});j.bind("FileUploaded",function(E,B){B.status=u.DONE;B.loaded=B.size;E.trigger("UploadProgress",B);y(function(){c.call(j);},1);});if(d.runtimes){h=[];n=d.runtimes.split(/\s?,\s?/);for(C=0;C<n.length;C++){if(q[n[C]]){h.push(q[n[C]]);}}}else{h=q;}function l(){var B=h[m++],G,I,H;if(B){G=B.getFeatures();I=j.settings.required_features;if(I){I=I.split(",");for(H=0;H<I.length;H++){if(!G[I[H]]){l();return;}}}B.init(j,function(D){if(D&&D.success){j.features=G;j.runtime=B.name;j.trigger("Init",{runtime:B.name});j.trigger("PostInit");j.refresh();}else{l();}});}else{j.trigger("Error",{code:u.INIT_ERROR,message:u.translate("Init error.")});}}l();if(typeof(d.init)=="function"){d.init(j);}else{u.each(d.init,function(B,E){j.bind(E,B);});}},refresh:function(){this.trigger("Refresh");},start:function(){if(this.state!=u.STARTED){this.state=u.STARTED;this.trigger("StateChanged");c.call(this);}},stop:function(){if(this.state!=u.STOPPED){this.state=u.STOPPED;this.trigger("StateChanged");}},getFile:function(h){var j;for(j=b.length-1;j>=0;j--){if(b[j].id===h){return b[j];}}},removeFile:function(h){var j;for(j=b.length-1;j>=0;j--){if(b[j].id===h.id){return this.splice(j,1)[0];}}},splice:function(h,k){var j;j=b.splice(h===z?0:h,k===z?b.length:k);this.trigger("FilesRemoved",j);this.trigger("QueueChanged");return j;},trigger:function(j){var l=f[j.toLowerCase()],h,k;if(l){k=Array.prototype.slice.call(arguments);k[0]=this;for(h=0;h<l.length;h++){if(l[h].func.apply(l[h].scope,k)===false){return false;}}}return true;},hasEventListener:function(h){return !!f[h.toLowerCase()];},bind:function(k,h,j){var l;k=k.toLowerCase();l=f[k]||[];l.push({func:h,scope:j||this});f[k]=l;},unbind:function(k){k=k.toLowerCase();var l=f[k],j,h=arguments[1];if(l){if(h!==z){for(j=l.length-1;j>=0;j--){if(l[j].func===h){l.splice(j,1);break;}}}else{l=[];}if(!l.length){delete f[k];}}},unbindAll:function(){var h=this;u.each(f,function(j,k){h.unbind(k);});},destroy:function(){this.trigger("Destroy");this.unbindAll();}});};u.File=function(a,c,b){var d=this;d.id=a;d.name=c;d.size=b;d.loaded=0;d.percent=0;d.status=0;};u.Runtime=function(){this.getFeatures=function(){};this.init=function(b,a){};};u.QueueProgress=function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0;};};u.runtimes={};window.plupload=u;})();(function(){if(window.google&&google.gears){return;}var d=null;if(typeof GearsFactory!="undefined"){d=new GearsFactory();}else{try{d=new ActiveXObject("Gears.Factory");if(d.getBuildInfo().indexOf("ie_mobile")!=-1){d.privateSetGlobalObject(this);}}catch(c){if((typeof navigator.mimeTypes!="undefined")&&navigator.mimeTypes["application/x-googlegears"]){d=document.createElement("object");d.style.display="none";d.width=0;d.height=0;d.type="application/x-googlegears";document.documentElement.appendChild(d);}}}if(!d){return;}if(!window.google){window.google={};}if(!google.gears){google.gears={factory:d};}})();(function(k,g,m,l){var j={};function h(e,c,a){var f,d,b,p;d=google.gears.factory.create("beta.canvas");try{d.decode(e);if(!c.width){c.width=d.width;}if(!c.height){c.height=d.height;}p=Math.min(width/d.width,height/d.height);if(p<1||(p===1&&a==="image/jpeg")){d.resize(Math.round(d.width*p),Math.round(d.height*p));if(c.quality){return d.encode(a,{quality:c.quality/100});}return d.encode(a);}}catch(q){}return e;}m.runtimes.Gears=m.addRuntime("gears",{getFeatures:function(){return{dragdrop:true,jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true,multi_selection:true};},init:function(c,a){var b;if(!k.google||!google.gears){return a({success:false});}try{b=google.gears.factory.create("beta.desktop");}catch(d){return a({success:false});}function e(t){var u,f,s=[],r;for(f=0;f<t.length;f++){u=t[f];r=m.guid();j[r]=u.blob;s.push(new m.File(r,u.name,u.blob.length));}c.trigger("FilesAdded",s);}c.bind("PostInit",function(){var o=c.settings,f=g.getElementById(o.drop_element);if(f){m.addEvent(f,"dragover",function(n){b.setDropEffect(n,"copy");n.preventDefault();},c.id);m.addEvent(f,"drop",function(n){var q=b.getDragData(n,"application/x-gears-files");if(q){e(q.files);}n.preventDefault();},c.id);f=0;}m.addEvent(g.getElementById(o.browse_button),"click",function(n){var t=[],v,w,u;n.preventDefault();no_type_restriction:for(v=0;v<o.filters.length;v++){u=o.filters[v].extensions.split(",");for(w=0;w<u.length;w++){if(u[w]==="*"){t=[];break no_type_restriction;}t.push("."+u[w]);}}b.openFiles(e,{singleFile:!o.multi_selection,filter:t});},c.id);});c.bind("UploadFile",function(C,w){var A=0,B,v,f=0,x=C.settings.resize,z;if(x&&/\.(png|jpg|jpeg)$/i.test(w.name)){j[w.id]=h(j[w.id],x,/\.png$/i.test(w.name)?"image/png":"image/jpeg");}w.size=j[w.id].length;v=C.settings.chunk_size;z=v>0;B=Math.ceil(w.size/v);if(!z){v=w.size;B=1;}function y(){var r,t,p=C.settings.multipart,q=0,o={name:w.target_name||w.name},n=C.settings.url;function s(N){var O,u="----pluploadboundary"+m.guid(),L="--",J="\r\n",M,K;if(p){r.setRequestHeader("Content-Type","multipart/form-data; boundary="+u);O=google.gears.factory.create("beta.blobbuilder");m.each(m.extend(o,C.settings.multipart_params),function(D,E){O.append(L+u+J+'Content-Disposition: form-data; name="'+E+'"'+J+J);O.append(D+J);});K=m.mimeTypes[w.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";O.append(L+u+J+'Content-Disposition: form-data; name="'+C.settings.file_data_name+'"; filename="'+w.name+'"'+J+"Content-Type: "+K+J+J);O.append(N);O.append(J+L+u+L+J);M=O.getAsBlob();q=M.length-N.length;N=M;}r.send(N);}if(w.status==m.DONE||w.status==m.FAILED||C.state==m.STOPPED){return;}if(z){o.chunk=A;o.chunks=B;}t=Math.min(v,w.size-(A*v));if(!p){n=m.buildUrl(C.settings.url,o);}r=google.gears.factory.create("beta.httprequest");r.open("POST",n);if(!p){r.setRequestHeader("Content-Disposition",'attachment; filename="'+w.name+'"');r.setRequestHeader("Content-Type","application/octet-stream");}m.each(C.settings.headers,function(u,E){r.setRequestHeader(E,u);});r.upload.onprogress=function(u){w.loaded=f+u.loaded-q;C.trigger("UploadProgress",w);};r.onreadystatechange=function(){var u;if(r.readyState==4){if(r.status==200){u={chunk:A,chunks:B,response:r.responseText,status:r.status};C.trigger("ChunkUploaded",w,u);if(u.cancelled){w.status=m.FAILED;return;}f+=t;if(++A>=B){w.status=m.DONE;C.trigger("FileUploaded",w,{response:r.responseText,status:r.status});}else{y();}}else{C.trigger("Error",{code:m.HTTP_ERROR,message:m.translate("HTTP Error."),file:w,chunk:A,chunks:B,status:r.status});}}};if(A<B){s(j[w.id].slice(A*v,t));}}y();});c.bind("Destroy",function(f){var s,r,q={browseButton:f.settings.browse_button,dropElm:f.settings.drop_element};for(s in q){r=g.getElementById(q[s]);if(r){m.removeAllEvents(r,f.id);}}});a({success:true});}});})(window,document,plupload);(function(m,j,p,o){var k={},l={};function q(e){var f,a=typeof e,d,b,c;if(e===o||e===null){return"null";}if(a==="string"){f="\bb\tt\nn\ff\rr\"\"''\\\\";return'"'+e.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(g,h){var s=f.indexOf(h);if(s+1){return"\\"+f.charAt(s+1);}g=h.charCodeAt().toString(16);return"\\u"+"0000".substring(g.length)+g;})+'"';}if(a=="object"){d=e.length!==o;f="";if(d){for(b=0;b<e.length;b++){if(f){f+=",";}f+=q(e[b]);}f="["+f+"]";}else{for(c in e){if(e.hasOwnProperty(c)){if(f){f+=",";}f+=q(c)+":"+q(e[c]);}}f="{"+f+"}";}return f;}return""+e;}function n(A){var x=false,w=null,d=null,h,g,f,y,e,b=0;try{try{d=new ActiveXObject("AgControl.AgControl");if(d.IsVersionSupported(A)){x=true;}d=null;}catch(a){var c=navigator.plugins["Silverlight Plug-In"];if(c){h=c.description;if(h==="1.0.30226.2"){h="2.0.30226.2";}g=h.split(".");while(g.length>3){g.pop();}while(g.length<4){g.push(0);}f=A.split(".");while(f.length>4){f.pop();}do{y=parseInt(f[b],10);e=parseInt(g[b],10);b++;}while(b<f.length&&y===e);if(y<=e&&!isNaN(y)){x=true;}}}}catch(z){x=false;}return x;}p.silverlight={trigger:function(e,c){var a=k[e],b,d;if(a){d=p.toArray(arguments).slice(1);d[0]="Silverlight:"+c;setTimeout(function(){a.trigger.apply(a,d);},0);}}};p.runtimes.Silverlight=p.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true,multi_selection:true};},init:function(f,e){var g,a="",h=f.settings.filters,b,c=j.body;if(!n("2.0.31005.0")||(m.opera&&m.opera.buildNumber)){e({success:false});return;}l[f.id]=false;k[f.id]=f;g=j.createElement("div");g.id=f.id+"_silverlight_container";p.extend(g.style,{position:"absolute",top:"0px",background:f.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:f.settings.shim_bgcolor||j.documentMode>8?"":0.01});g.className="plupload silverlight";if(f.settings.container){c=j.getElementById(f.settings.container);if(p.getStyle(c,"position")==="static"){c.style.position="relative";}}c.appendChild(g);for(b=0;b<h.length;b++){a+=(a!=""?"|":"")+h[b].title+" | *."+h[b].extensions.replace(/,/g,";*.");}g.innerHTML='<object id="'+f.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+f.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+f.id+",filter="+a+",multiselect="+f.settings.multi_selection+'"/></object>';function d(){return j.getElementById(f.id+"_silverlight").content.Upload;}f.bind("Silverlight:Init",function(){var u,t={};if(l[f.id]){return;}l[f.id]=true;f.bind("Silverlight:StartSelectFiles",function(r){u=[];});f.bind("Silverlight:SelectFile",function(A,s,z,y){var r;r=p.guid();t[r]=s;t[s]=r;u.push(new p.File(r,z,y));});f.bind("Silverlight:SelectSuccessful",function(){if(u.length){f.trigger("FilesAdded",u);}});f.bind("Silverlight:UploadChunkError",function(A,s,z,r,y){f.trigger("Error",{code:p.IO_ERROR,message:"IO Error.",details:y,file:A.getFile(t[s])});});f.bind("Silverlight:UploadFileProgress",function(A,r,z,s){var y=A.getFile(t[r]);if(y.status!=p.FAILED){y.size=s;y.loaded=z;A.trigger("UploadProgress",y);}});f.bind("Refresh",function(y){var x,s,r;x=j.getElementById(y.settings.browse_button);if(x){s=p.getPos(x,j.getElementById(y.settings.container));r=p.getSize(x);p.extend(j.getElementById(y.id+"_silverlight_container").style,{top:s.y+"px",left:s.x+"px",width:r.w+"px",height:r.h+"px"});}});f.bind("Silverlight:UploadChunkSuccessful",function(C,s,B,D,E){var r,A=C.getFile(t[s]);r={chunk:B,chunks:D,response:E};C.trigger("ChunkUploaded",A,r);if(A.status!=p.FAILED){d().UploadNextChunk();}if(B==D-1){A.status=p.DONE;C.trigger("FileUploaded",A,{response:E});}});f.bind("Silverlight:UploadSuccessful",function(y,r,x){var s=y.getFile(t[r]);s.status=p.DONE;y.trigger("FileUploaded",s,{response:x});});f.bind("FilesRemoved",function(w,r){var s;for(s=0;s<r.length;s++){d().RemoveFile(t[r[s].id]);}});f.bind("UploadFile",function(y,s){var r=y.settings,x=r.resize||{};d().UploadFile(t[s.id],y.settings.url,q({name:s.target_name||s.name,mime:p.mimeTypes[s.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:r.chunk_size,image_width:x.width,image_height:x.height,image_quality:x.quality||90,multipart:!!r.multipart,multipart_params:r.multipart_params||{},file_data_name:r.file_data_name,headers:r.headers}));});f.bind("Silverlight:MouseEnter",function(w){var s,r;s=j.getElementById(f.settings.browse_button);r=w.settings.browse_button_hover;if(s&&r){p.addClass(s,r);}});f.bind("Silverlight:MouseLeave",function(w){var s,r;s=j.getElementById(f.settings.browse_button);r=w.settings.browse_button_hover;if(s&&r){p.removeClass(s,r);}});f.bind("Silverlight:MouseLeftButtonDown",function(w){var s,r;s=j.getElementById(f.settings.browse_button);r=w.settings.browse_button_active;if(s&&r){p.addClass(s,r);p.addEvent(j.body,"mouseup",function(){p.removeClass(s,r);});}});f.bind("Sliverlight:StartSelectFiles",function(w){var s,r;s=j.getElementById(f.settings.browse_button);r=w.settings.browse_button_active;if(s&&r){p.removeClass(s,r);}});f.bind("Destroy",function(s){var r;p.removeAllEvents(j.body,s.id);delete l[s.id];delete k[s.id];r=j.getElementById(s.id+"_silverlight_container");if(r){c.removeChild(r);}});e({success:true});});}});})(window,document,plupload);(function(l,h,n,m){var j={},k={};function o(){var c;try{c=navigator.plugins["Shockwave Flash"];c=c.description;}catch(a){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version");}catch(b){c="0.0";}}c=c.match(/\d+/g);return parseFloat(c[0]+"."+c[1]);}n.flash={trigger:function(a,c,b){setTimeout(function(){var f=j[a],d,e;if(f){f.trigger("Flash:"+c,b);}},0);}};n.runtimes.Flash=n.addRuntime("flash",{getFeatures:function(){return{jpgresize:true,pngresize:true,maxWidth:8091,maxHeight:8091,chunks:true,progress:true,multipart:true,multi_selection:true};},init:function(q,f){var b,a,e=0,d=h.body;if(o()<10){f({success:false});return;}k[q.id]=false;j[q.id]=q;b=h.getElementById(q.settings.browse_button);a=h.createElement("div");a.id=q.id+"_flash_container";n.extend(a.style,{position:"absolute",top:"0px",background:q.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"});a.className="plupload flash";if(q.settings.container){d=h.getElementById(q.settings.container);if(n.getStyle(d,"position")==="static"){d.style.position="relative";}}d.appendChild(a);(function(){var s,p;s='<object id="'+q.id+'_flash" type="application/x-shockwave-flash" data="'+q.settings.flash_swf_url+'" ';if(n.ua.ie){s+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ';}s+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+q.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(q.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';if(n.ua.ie){p=h.createElement("div");a.appendChild(p);p.outerHTML=s;p=null;}else{a.innerHTML=s;}}());function g(){return h.getElementById(q.id+"_flash");}function c(){if(e++>5000){f({success:false});return;}if(!k[q.id]){setTimeout(c,1);}}c();b=a=null;q.bind("Flash:Init",function(){var p={},s;g().setFileFilters(q.settings.filters,q.settings.multi_selection);if(k[q.id]){return;}k[q.id]=true;q.bind("UploadFile",function(y,w){var r=y.settings,x=q.settings.resize||{};g().uploadFile(p[w.id],r.url,{name:w.target_name||w.name,mime:n.mimeTypes[w.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:r.chunk_size,width:x.width,height:x.height,quality:x.quality,multipart:r.multipart,multipart_params:r.multipart_params||{},file_data_name:r.file_data_name,format:/\.(jpg|jpeg)$/i.test(w.name)?"jpg":"png",headers:r.headers,urlstream_upload:r.urlstream_upload});});q.bind("Flash:UploadProcess",function(v,w){var r=v.getFile(p[w.id]);if(r.status!=n.FAILED){r.loaded=w.loaded;r.size=w.size;v.trigger("UploadProgress",r);}});q.bind("Flash:UploadChunkComplete",function(y,w){var r,x=y.getFile(p[w.id]);r={chunk:w.chunk,chunks:w.chunks,response:w.text};y.trigger("ChunkUploaded",x,r);if(x.status!=n.FAILED){g().uploadNextChunk();}if(w.chunk==w.chunks-1){x.status=n.DONE;y.trigger("FileUploaded",x,{response:w.text});}});q.bind("Flash:SelectFiles",function(C,z){var A,B,y=[],r;for(B=0;B<z.length;B++){A=z[B];r=n.guid();p[r]=A.id;p[A.id]=r;y.push(new n.File(r,A.name,A.size));}if(y.length){q.trigger("FilesAdded",y);}});q.bind("Flash:SecurityError",function(u,r){q.trigger("Error",{code:n.SECURITY_ERROR,message:n.translate("Security error."),details:r.message,file:q.getFile(p[r.id])});});q.bind("Flash:GenericError",function(u,r){q.trigger("Error",{code:n.GENERIC_ERROR,message:n.translate("Generic error."),details:r.message,file:q.getFile(p[r.id])});});q.bind("Flash:IOError",function(u,r){q.trigger("Error",{code:n.IO_ERROR,message:n.translate("IO error."),details:r.message,file:q.getFile(p[r.id])});});q.bind("Flash:ImageError",function(u,r){q.trigger("Error",{code:parseInt(r.code,10),message:n.translate("Image error."),file:q.getFile(p[r.id])});});q.bind("Flash:StageEvent:rollOver",function(w){var v,r;v=h.getElementById(q.settings.browse_button);r=w.settings.browse_button_hover;if(v&&r){n.addClass(v,r);}});q.bind("Flash:StageEvent:rollOut",function(w){var v,r;v=h.getElementById(q.settings.browse_button);r=w.settings.browse_button_hover;if(v&&r){n.removeClass(v,r);}});q.bind("Flash:StageEvent:mouseDown",function(w){var v,r;v=h.getElementById(q.settings.browse_button);r=w.settings.browse_button_active;if(v&&r){n.addClass(v,r);n.addEvent(h.body,"mouseup",function(){n.removeClass(v,r);},w.id);}});q.bind("Flash:StageEvent:mouseUp",function(w){var v,r;v=h.getElementById(q.settings.browse_button);r=w.settings.browse_button_active;if(v&&r){n.removeClass(v,r);}});q.bind("Flash:ExifData",function(u,r){q.trigger("ExifData",q.getFile(p[r.id]),r.data);});q.bind("Flash:GpsData",function(u,r){q.trigger("GpsData",q.getFile(p[r.id]),r.data);});q.bind("QueueChanged",function(r){q.refresh();});q.bind("FilesRemoved",function(w,r){var v;for(v=0;v<r.length;v++){g().removeFile(p[r[v].id]);}});q.bind("StateChanged",function(r){q.refresh();});q.bind("Refresh",function(y){var x,w,r;g().setFileFilters(q.settings.filters,q.settings.multi_selection);x=h.getElementById(y.settings.browse_button);if(x){w=n.getPos(x,h.getElementById(y.settings.container));r=n.getSize(x);n.extend(h.getElementById(y.id+"_flash_container").style,{top:w.y+"px",left:w.x+"px",width:r.w+"px",height:r.h+"px"});}});q.bind("Destroy",function(u){var r;n.removeAllEvents(h.body,u.id);delete k[u.id];delete j[u.id];r=h.getElementById(u.id+"_flash_container");if(r){d.removeChild(r);}});f({success:true});});}});})(window,document,plupload);(function(b){b.runtimes.BrowserPlus=b.addRuntime("browserplus",{getFeatures:function(){return{dragdrop:true,jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true,multi_selection:true};},init:function(m,k){var o=window.BrowserPlus,l={},p=m.settings,q=p.resize;function n(g){var h,c,e=[],d,f;for(c=0;c<g.length;c++){d=g[c];f=b.guid();l[f]=d;e.push(new b.File(f,d.name,d.size));}if(c){m.trigger("FilesAdded",e);}}function a(){m.bind("PostInit",function(){var j,d=p.drop_element,g=m.id+"_droptarget",e=document.getElementById(d),c;function f(t,u){o.DragAndDrop.AddDropTarget({id:t},function(r){o.DragAndDrop.AttachCallbacks({id:t,hover:function(s){if(!s&&u){u();}},drop:function(s){if(u){u();}n(s);}},function(){});});}function h(){document.getElementById(g).style.top="-1000px";}if(e){if(document.attachEvent&&(/MSIE/gi).test(navigator.userAgent)){j=document.createElement("div");j.setAttribute("id",g);b.extend(j.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0});document.body.appendChild(j);b.addEvent(e,"dragenter",function(v){var w,u;w=document.getElementById(d);u=b.getPos(w);b.extend(document.getElementById(g).style,{top:u.y+"px",left:u.x+"px",width:w.offsetWidth+"px",height:w.offsetHeight+"px"});});f(g,h);}else{f(d);}}b.addEvent(document.getElementById(p.browse_button),"click",function(x){var z=[],B,C,y=p.filters,A;x.preventDefault();no_type_restriction:for(B=0;B<y.length;B++){A=y[B].extensions.split(",");for(C=0;C<A.length;C++){if(A[C]==="*"){z=[];break no_type_restriction;}z.push(b.mimeTypes[A[C]]);}}o.FileBrowse.OpenBrowseDialog({mimeTypes:z},function(r){if(r.success){n(r.value);}});});e=j=null;});m.bind("UploadFile",function(g,t){var h=l[t.id],u={},j=g.settings.chunk_size,f,e=[];function c(w,r){var s;if(t.status==b.FAILED){return;}u.name=t.target_name||t.name;if(j){u.chunk=""+w;u.chunks=""+r;}s=e.shift();o.Uploader.upload({url:g.settings.url,files:{file:s},cookies:document.cookies,postvars:b.extend(u,g.settings.multipart_params),progressCallback:function(A){var v,z=0;f[w]=parseInt(A.filePercent*s.size/100,10);for(v=0;v<f.length;v++){z+=f[v];}t.loaded=z;g.trigger("UploadProgress",t);}},function(v){var z,A;if(v.success){z=v.value.statusCode;if(j){g.trigger("ChunkUploaded",t,{chunk:w,chunks:r,response:v.value.body,status:z});}if(e.length>0){c(++w,r);}else{t.status=b.DONE;g.trigger("FileUploaded",t,{response:v.value.body,status:z});if(z>=400){g.trigger("Error",{code:b.HTTP_ERROR,message:b.translate("HTTP Error."),file:t,status:z});}}}else{g.trigger("Error",{code:b.GENERIC_ERROR,message:b.translate("Generic Error."),file:t,details:v.error});}});}function d(r){t.size=r.size;if(j){o.FileAccess.chunk({file:r,chunkSize:j},function(y){if(y.success){var s=y.value,A=s.length;f=Array(A);for(var z=0;z<A;z++){f[z]=0;e.push(s[z]);}c(0,A);}});}else{f=Array(1);e.push(r);c(0,1);}}if(q&&/\.(png|jpg|jpeg)$/i.test(t.name)){BrowserPlus.ImageAlter.transform({file:h,quality:q.quality||90,actions:[{scale:{maxwidth:q.width,maxheight:q.height}}]},function(r){if(r.success){d(r.value.file);}});}else{d(h);}});k({success:true});}if(o){o.init(function(c){var d=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];if(q){d.push({service:"ImageAlter",version:"4"});}if(c.success){o.require({services:d},function(e){if(e.success){a();}else{k();}});}else{k();}});}else{k();}}});})(plupload);(function(r,p,q,u){var w={},s;function n(b,a){var c;if("FileReader" in r){c=new FileReader();c.readAsDataURL(b);c.onload=function(){a(c.result);};}else{return a(b.getAsDataURL());}}function o(b,a){var c;if("FileReader" in r){c=new FileReader();c.readAsBinaryString(b);c.onload=function(){a(c.result);};}else{return a(b.getAsBinary());}}function v(a,c,e,f){var b,d,g,j,h=this;n(w[a.id],function(k){b=p.createElement("canvas");b.style.display="none";p.body.appendChild(b);d=b.getContext("2d");g=new Image();g.onerror=g.onabort=function(){f({success:false});};g.onload=function(){var G,m,E,F,l;if(!c.width){c.width=g.width;}if(!c.height){c.height=g.height;}j=Math.min(c.width/g.width,c.height/g.height);if(j<1||(j===1&&e==="image/jpeg")){G=Math.round(g.width*j);m=Math.round(g.height*j);b.width=G;b.height=m;d.drawImage(g,0,0,G,m);if(e==="image/jpeg"){F=new t(atob(k.substring(k.indexOf("base64,")+7)));if(F.headers&&F.headers.length){l=new y();if(l.init(F.get("exif")[0])){l.setExif("PixelXDimension",G);l.setExif("PixelYDimension",m);F.set("exif",l.getBinary());if(h.hasEventListener("ExifData")){h.trigger("ExifData",a,l.EXIF());}if(h.hasEventListener("GpsData")){h.trigger("GpsData",a,l.GPS());}}}if(c.quality){try{k=b.toDataURL(e,c.quality/100);}catch(D){k=b.toDataURL(e);}}}else{k=b.toDataURL(e);}k=k.substring(k.indexOf("base64,")+7);k=atob(k);if(F&&F.headers&&F.headers.length){k=F.restore(k);F.purge();}b.parentNode.removeChild(b);f({success:true,data:k});}else{f({success:false});}};g.src=k;});}q.runtimes.Html5=q.addRuntime("html5",{getFeatures:function(){var a,e,b,c,d,f;e=b=d=f=false;if(r.XMLHttpRequest){a=new XMLHttpRequest();b=!!a.upload;e=!!(a.sendAsBinary||a.upload);}if(e){c=!!(a.sendAsBinary||(r.Uint8Array&&r.ArrayBuffer));d=!!(File&&(File.prototype.getAsDataURL||r.FileReader)&&c);f=!!(File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice));}s=q.ua.safari&&q.ua.windows;return{html5:e,dragdrop:(function(){var g=p.createElement("div");return("draggable" in g)||("ondragstart" in g&&"ondrop" in g);}()),jpgresize:d,pngresize:d,multipart:d||!!r.FileReader||!!r.FormData,canSendBinary:c,cantSendBlobInFormData:!!(q.ua.gecko&&r.FormData&&r.FileReader&&!FileReader.prototype.readAsArrayBuffer),progress:b,chunks:f,multi_selection:!(q.ua.safari&&q.ua.windows),triggerDialog:(q.ua.gecko&&r.FormData||q.ua.webkit)};},init:function(b,a){var d;function c(f){var h,j,g=[],e,k={};for(j=0;j<f.length;j++){h=f[j];if(k[h.name]){continue;}k[h.name]=true;e=q.guid();w[e]=h;g.push(new q.File(e,h.fileName||h.name,h.fileSize||h.size));}if(g.length){b.trigger("FilesAdded",g);}}d=this.getFeatures();if(!d.html5){a({success:false});return;}b.bind("Init",function(G){var I,K,h=[],H,g,L=G.settings.filters,J,j,f=p.body,e;I=p.createElement("div");I.id=G.id+"_html5_container";q.extend(I.style,{position:"absolute",background:b.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:b.settings.shim_bgcolor?"":0});I.className="plupload html5";if(b.settings.container){f=p.getElementById(b.settings.container);if(q.getStyle(f,"position")==="static"){f.style.position="relative";}}f.appendChild(I);no_type_restriction:for(H=0;H<L.length;H++){J=L[H].extensions.split(/,/);for(g=0;g<J.length;g++){if(J[g]==="*"){h=[];break no_type_restriction;}j=q.mimeTypes[J[g]];if(j){h.push(j);}}}I.innerHTML='<input id="'+b.id+'_html5"  style="font-size:999px" type="file" accept="'+h.join(",")+'" '+(b.settings.multi_selection&&b.features.multi_selection?'multiple="multiple"':"")+" />";I.scrollTop=100;e=p.getElementById(b.id+"_html5");if(G.features.triggerDialog){q.extend(e.style,{position:"absolute",width:"100%",height:"100%"});}else{q.extend(e.style,{cssFloat:"right",styleFloat:"right"});}e.onchange=function(){c(this.files);this.value="";};K=p.getElementById(G.settings.browse_button);if(K){var l=G.settings.browse_button_hover,k=G.settings.browse_button_active,m=G.features.triggerDialog?K:I;if(l){q.addEvent(m,"mouseover",function(){q.addClass(K,l);},G.id);q.addEvent(m,"mouseout",function(){q.removeClass(K,l);},G.id);}if(k){q.addEvent(m,"mousedown",function(){q.addClass(K,k);},G.id);q.addEvent(p.body,"mouseup",function(){q.removeClass(K,k);},G.id);}if(G.features.triggerDialog){q.addEvent(K,"click",function(z){p.getElementById(G.id+"_html5").click();z.preventDefault();},G.id);}}});b.bind("PostInit",function(){var e=p.getElementById(b.settings.drop_element);if(e){if(s){q.addEvent(e,"dragenter",function(f){var g,j,h;g=p.getElementById(b.id+"_drop");if(!g){g=p.createElement("input");g.setAttribute("type","file");g.setAttribute("id",b.id+"_drop");g.setAttribute("multiple","multiple");q.addEvent(g,"change",function(){c(this.files);q.removeEvent(g,"change",b.id);g.parentNode.removeChild(g);},b.id);e.appendChild(g);}j=q.getPos(e,p.getElementById(b.settings.container));h=q.getSize(e);if(q.getStyle(e,"position")==="static"){q.extend(e.style,{position:"relative"});}q.extend(g.style,{position:"absolute",display:"block",top:0,left:0,width:h.w+"px",height:h.h+"px",opacity:0});},b.id);return;}q.addEvent(e,"dragover",function(f){f.preventDefault();},b.id);q.addEvent(e,"drop",function(f){var g=f.dataTransfer;if(g&&g.files){c(g.files);}f.preventDefault();},b.id);}});b.bind("Refresh",function(k){var j,h,g,e,f;j=p.getElementById(b.settings.browse_button);if(j){h=q.getPos(j,p.getElementById(k.settings.container));g=q.getSize(j);e=p.getElementById(b.id+"_html5_container");q.extend(e.style,{top:h.y+"px",left:h.x+"px",width:g.w+"px",height:g.h+"px"});if(b.features.triggerDialog){if(q.getStyle(j,"position")==="static"){q.extend(j.style,{position:"relative"});}f=parseInt(q.getStyle(j,"z-index"),10);if(isNaN(f)){f=0;}q.extend(j.style,{zIndex:f});q.extend(e.style,{zIndex:f-1});}}});b.bind("UploadFile",function(l,j){var h=l.settings,e,k;function f(E,D,G){var m;if(File.prototype.slice){try{E.slice();return E.slice(D,G);}catch(F){return E.slice(D,G-D);}}else{if(m=File.prototype.webkitSlice||File.prototype.mozSlice){return m.call(E,D,G);}else{return null;}}}function g(E){var D=0,G=0,F=("FileReader" in r)?new FileReader:null;function m(){var N,A,C,B,O,M,Q,z=l.settings.url;function P(I){var L=0,K=new XMLHttpRequest,H=K.upload,ac="----pluploadboundary"+q.guid(),ab,aa="--",J="\r\n",Y="";if(H){H.onprogress=function(R){j.loaded=Math.min(j.size,G+R.loaded-L);l.trigger("UploadProgress",j);};}K.onreadystatechange=function(){var T,R;if(K.readyState==4){try{T=K.status;}catch(S){T=0;}if(T>=400){l.trigger("Error",{code:q.HTTP_ERROR,message:q.translate("HTTP Error."),file:j,status:T});}else{if(C){R={chunk:D,chunks:C,response:K.responseText,status:T};l.trigger("ChunkUploaded",j,R);G+=M;if(R.cancelled){j.status=q.FAILED;return;}j.loaded=Math.min(j.size,(D+1)*O);}else{j.loaded=j.size;}l.trigger("UploadProgress",j);I=N=ab=Y=null;if(!C||++D>=C){j.status=q.DONE;l.trigger("FileUploaded",j,{response:K.responseText,status:T});}else{m();}}K=null;}};if(l.settings.multipart&&d.multipart){B.name=j.target_name||j.name;K.open("post",z,true);q.each(l.settings.headers,function(R,S){K.setRequestHeader(S,R);});if(typeof(I)!=="string"&&!!r.FormData){ab=new FormData();q.each(q.extend(B,l.settings.multipart_params),function(R,S){ab.append(S,R);});ab.append(l.settings.file_data_name,I);K.send(ab);return;}if(typeof(I)==="string"){K.setRequestHeader("Content-Type","multipart/form-data; boundary="+ac);q.each(q.extend(B,l.settings.multipart_params),function(R,S){Y+=aa+ac+J+'Content-Disposition: form-data; name="'+S+'"'+J+J;Y+=unescape(encodeURIComponent(R))+J;});Q=q.mimeTypes[j.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";Y+=aa+ac+J+'Content-Disposition: form-data; name="'+l.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(j.name))+'"'+J+"Content-Type: "+Q+J+J+I+J+aa+ac+aa+J;L=Y.length-I.length;I=Y;if(K.sendAsBinary){K.sendAsBinary(I);}else{if(d.canSendBinary){var X=new Uint8Array(I.length);for(var Z=0;Z<I.length;Z++){X[Z]=(I.charCodeAt(Z)&255);}K.send(X.buffer);}}return;}}z=q.buildUrl(l.settings.url,q.extend(B,l.settings.multipart_params));K.open("post",z,true);K.setRequestHeader("Content-Type","application/octet-stream");q.each(l.settings.headers,function(R,S){K.setRequestHeader(S,R);});K.send(I);}if(j.status==q.DONE||j.status==q.FAILED||l.state==q.STOPPED){return;}B={name:j.target_name||j.name};if(h.chunk_size&&j.size>h.chunk_size&&(d.chunks||typeof(E)=="string")){O=h.chunk_size;C=Math.ceil(j.size/O);M=Math.min(O,j.size-(D*O));if(typeof(E)=="string"){N=E.substring(D*O,D*O+M);}else{N=f(E,D*O,D*O+M);}B.chunk=D;B.chunks=C;}else{M=j.size;N=E;}if(typeof(N)!=="string"&&F&&d.cantSendBlobInFormData&&d.chunks&&l.settings.chunk_size){F.onload=function(){P(F.result);};F.readAsBinaryString(N);}else{P(N);}}m();}e=w[j.id];if(d.jpgresize&&l.settings.resize&&/\.(png|jpg|jpeg)$/i.test(j.name)){v.call(l,j,l.settings.resize,/\.png$/i.test(j.name)?"image/png":"image/jpeg",function(m){if(m.success){j.size=m.data.length;g(m.data);}else{g(e);}});}else{if(!d.chunks&&d.jpgresize){o(e,g);}else{g(e);}}});b.bind("Destroy",function(j){var g,f,h=p.body,e={inputContainer:j.id+"_html5_container",inputFile:j.id+"_html5",browseButton:j.settings.browse_button,dropElm:j.settings.drop_element};for(g in e){f=p.getElementById(e[g]);if(f){q.removeAllEvents(f,j.id);}}q.removeAllEvents(p.body,j.id);if(j.settings.container){h=p.getElementById(j.settings.container);}h.removeChild(p.getElementById(e.inputContainer));});a({success:true});}});function x(){var b=false,d;function a(j,g){var k=b?0:-8*(g-1),f=0,h;for(h=0;h<g;h++){f|=(d.charCodeAt(j+h)<<Math.abs(k+h*8));}return f;}function e(f,h,g){var g=arguments.length===3?g:d.length-h-1;d=d.substr(0,h)+f+d.substr(g+h);}function c(k,j,g){var f="",l=b?0:-8*(g-1),h;for(h=0;h<g;h++){f+=String.fromCharCode((j>>Math.abs(l+h*8))&255);}e(f,k,g);}return{II:function(f){if(f===u){return b;}else{b=f;}},init:function(f){b=false;d=f;},SEGMENT:function(h,f,g){switch(arguments.length){case 1:return d.substr(h,d.length-h-1);case 2:return d.substr(h,f);case 3:e(g,h,f);break;default:return d;}},BYTE:function(f){return a(f,1);},SHORT:function(f){return a(f,2);},LONG:function(g,f){if(f===u){return a(g,4);}else{c(g,f,4);}},SLONG:function(g){var f=a(g,4);return(f>2147483647?f-4294967296:f);},STRING:function(h,g){var f="";for(g+=h;h<g;h++){f+=String.fromCharCode(a(h,1));}return f;}};}function t(c){var a={65505:{app:"EXIF",name:"APP1",signature:"Exif\0"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\0"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\0"}},b=[],d,h,f=u,e=0,g;d=new x();d.init(c);if(d.SHORT(0)!==65496){return;}h=2;g=Math.min(1048576,c.length);while(h<=g){f=d.SHORT(h);if(f>=65488&&f<=65495){h+=2;continue;}if(f===65498||f===65497){break;}e=d.SHORT(h+2)+2;if(a[f]&&d.STRING(h+4,a[f].signature.length)===a[f].signature){b.push({hex:f,app:a[f].app.toUpperCase(),name:a[f].name.toUpperCase(),start:h,length:e,segment:d.SEGMENT(h,e)});}h+=e;}d.init(null);return{headers:b,restore:function(A){d.init(A);var k=new t(A);if(!k.headers){return false;}for(var j=k.headers.length;j>0;j--){var m=k.headers[j-1];d.SEGMENT(m.start,m.length,"");}k.purge();h=d.SHORT(2)==65504?4+d.SHORT(4):2;for(var j=0,l=b.length;j<l;j++){d.SEGMENT(h,0,b[j].segment);h+=b[j].length;}return d.SEGMENT();},get:function(j){var m=[];for(var k=0,l=b.length;k<l;k++){if(b[k].app===j.toUpperCase()){m.push(b[k].segment);}}return m;},set:function(A,j){var m=[];if(typeof(j)==="string"){m.push(j);}else{m=j;}for(var k=ii=0,l=b.length;k<l;k++){if(b[k].app===A.toUpperCase()){b[k].segment=m[ii];b[k].length=m[ii].length;ii++;}if(ii>=m.length){break;}}},purge:function(){b=[];d.init(null);}};}function y(){var d,g,f={},a;d=new x();g={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};a={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};function e(M,j){var J=d.SHORT(M),m,N,L,k,l,K,I,h,O=[],H={};for(m=0;m<J;m++){I=K=M+12*m+2;L=j[d.SHORT(I)];if(L===u){continue;}k=d.SHORT(I+=2);l=d.LONG(I+=2);I+=4;O=[];switch(k){case 1:case 7:if(l>4){I=d.LONG(I)+f.tiffHeader;}for(N=0;N<l;N++){O[N]=d.BYTE(I+N);}break;case 2:if(l>4){I=d.LONG(I)+f.tiffHeader;}H[L]=d.STRING(I,l-1);continue;case 3:if(l>2){I=d.LONG(I)+f.tiffHeader;}for(N=0;N<l;N++){O[N]=d.SHORT(I+N*2);}break;case 4:if(l>1){I=d.LONG(I)+f.tiffHeader;}for(N=0;N<l;N++){O[N]=d.LONG(I+N*4);}break;case 5:I=d.LONG(I)+f.tiffHeader;for(N=0;N<l;N++){O[N]=d.LONG(I+N*4)/d.LONG(I+N*4+4);}break;case 9:I=d.LONG(I)+f.tiffHeader;for(N=0;N<l;N++){O[N]=d.SLONG(I+N*4);}break;case 10:I=d.LONG(I)+f.tiffHeader;for(N=0;N<l;N++){O[N]=d.SLONG(I+N*4)/d.SLONG(I+N*4+4);}break;default:continue;}h=(l==1?O[0]:O);if(a.hasOwnProperty(L)&&typeof h!="object"){H[L]=a[L][h];}else{H[L]=h;}}return H;}function b(){var h=u,j=f.tiffHeader;d.II(d.SHORT(j)==18761);if(d.SHORT(j+=2)!==42){return false;}f.IFD0=f.tiffHeader+d.LONG(j+=2);h=e(f.IFD0,g.tiff);f.exifIFD=("ExifIFDPointer" in h?f.tiffHeader+h.ExifIFDPointer:u);f.gpsIFD=("GPSInfoIFDPointer" in h?f.tiffHeader+h.GPSInfoIFDPointer:u);return true;}function c(k,m,C){var E,D,j,h=0;if(typeof(m)==="string"){var l=g[k.toLowerCase()];for(hex in l){if(l[hex]===m){m=hex;break;}}}E=f[k.toLowerCase()+"IFD"];D=d.SHORT(E);for(i=0;i<D;i++){j=E+12*i+2;if(d.SHORT(j)==m){h=j+8;break;}}if(!h){return false;}d.LONG(h,C);return true;}return{init:function(h){f={tiffHeader:10};if(h===u||!h.length){return false;}d.init(h);if(d.SHORT(0)===65505&&d.STRING(4,5).toUpperCase()==="EXIF\0"){return b();}return false;},EXIF:function(){var h;h=e(f.exifIFD,g.exif);if(h.ExifVersion){h.ExifVersion=String.fromCharCode(h.ExifVersion[0],h.ExifVersion[1],h.ExifVersion[2],h.ExifVersion[3]);}return h;},GPS:function(){var h;h=e(f.gpsIFD,g.gps);if(h.GPSVersionID){h.GPSVersionID=h.GPSVersionID.join(".");}return h;},setExif:function(j,h){if(j!=="PixelXDimension"&&j!=="PixelYDimension"){return false;}return c("exif",j,h);},getBinary:function(){return d.SEGMENT();}};}})(window,document,plupload);(function(j,g,f,k){function h(a){return g.getElementById(a);}f.runtimes.Html4=f.addRuntime("html4",{getFeatures:function(){return{multipart:true,triggerDialog:(f.ua.gecko&&j.FormData||f.ua.webkit)};},init:function(b,a){b.bind("Init",function(e){var E=g.body,A,F="javascript",D,H,d,G=[],c=/MSIE/.test(navigator.userAgent),L=[],B=e.settings.filters,y,C,M,I;no_type_restriction:for(y=0;y<B.length;y++){C=B[y].extensions.split(/,/);for(I=0;I<C.length;I++){if(C[I]==="*"){L=[];break no_type_restriction;}M=f.mimeTypes[C[I]];if(M){L.push(M);}}}L=L.join(",");function J(){var m,l,o,n;d=f.guid();G.push(d);m=g.createElement("form");m.setAttribute("id","form_"+d);m.setAttribute("method","post");m.setAttribute("enctype","multipart/form-data");m.setAttribute("encoding","multipart/form-data");m.setAttribute("target",e.id+"_iframe");m.style.position="absolute";l=g.createElement("input");l.setAttribute("id","input_"+d);l.setAttribute("type","file");l.setAttribute("accept",L);l.setAttribute("size",1);n=h(e.settings.browse_button);if(e.features.triggerDialog&&n){f.addEvent(h(e.settings.browse_button),"click",function(p){l.click();p.preventDefault();},e.id);}f.extend(l.style,{width:"100%",height:"100%",opacity:0,fontSize:"999px"});f.extend(m.style,{overflow:"hidden"});o=e.settings.shim_bgcolor;if(o){m.style.background=o;}if(c){f.extend(l.style,{filter:"alpha(opacity=0)"});}f.addEvent(l,"change",function(q){var s=q.target,t,r=[],p;if(s.value){h("form_"+d).style.top=-1048575+"px";t=s.value.replace(/\\/g,"/");t=t.substring(t.length,t.lastIndexOf("/")+1);r.push(new f.File(d,t));if(!e.features.triggerDialog){f.removeAllEvents(m,e.id);}else{f.removeEvent(n,"click",e.id);}f.removeEvent(l,"change",e.id);J();if(r.length){b.trigger("FilesAdded",r);}}},e.id);m.appendChild(l);E.appendChild(m);e.refresh();}function K(){var l=g.createElement("div");l.innerHTML='<iframe id="'+e.id+'_iframe" name="'+e.id+'_iframe" src="'+F+':&quot;&quot;" style="display:none"></iframe>';A=l.firstChild;E.appendChild(A);f.addEvent(A,"load",function(o){var n=o.target,p,m;if(!D){return;}try{p=n.contentWindow.document||n.contentDocument||j.frames[n.id].document;}catch(q){e.trigger("Error",{code:f.SECURITY_ERROR,message:f.translate("Security error."),file:D});return;}m=p.body.innerHTML;if(m){D.status=f.DONE;D.loaded=1025;D.percent=100;e.trigger("UploadProgress",D);e.trigger("FileUploaded",D,{response:m});}},e.id);}if(e.settings.container){E=h(e.settings.container);if(f.getStyle(E,"position")==="static"){E.style.position="relative";}}e.bind("UploadFile",function(o,n){var m,l;if(n.status==f.DONE||n.status==f.FAILED||o.state==f.STOPPED){return;}m=h("form_"+n.id);l=h("input_"+n.id);l.setAttribute("name",o.settings.file_data_name);m.setAttribute("action",o.settings.url);f.each(f.extend({name:n.target_name||n.name},o.settings.multipart_params),function(p,r){var q=g.createElement("input");f.extend(q,{type:"hidden",name:r,value:p});m.insertBefore(q,m.firstChild);});D=n;h("form_"+d).style.top=-1048575+"px";m.submit();m.parentNode.removeChild(m);});e.bind("FileUploaded",function(l){l.refresh();});e.bind("StateChanged",function(l){if(l.state==f.STARTED){K();}if(l.state==f.STOPPED){j.setTimeout(function(){f.removeEvent(A,"load",l.id);if(A.parentNode){A.parentNode.removeChild(A);}},0);}});e.bind("Refresh",function(o){var s,n,m,l,p,r,q,t,u;s=h(o.settings.browse_button);if(s){p=f.getPos(s,h(o.settings.container));r=f.getSize(s);q=h("form_"+d);t=h("input_"+d);f.extend(q.style,{top:p.y+"px",left:p.x+"px",width:r.w+"px",height:r.h+"px"});if(o.features.triggerDialog){if(f.getStyle(s,"position")==="static"){f.extend(s.style,{position:"relative"});}u=parseInt(s.style.zIndex,10);if(isNaN(u)){u=0;}f.extend(s.style,{zIndex:u});f.extend(q.style,{zIndex:u-1});}m=o.settings.browse_button_hover;l=o.settings.browse_button_active;n=o.features.triggerDialog?s:q;if(m){f.addEvent(n,"mouseover",function(){f.addClass(s,m);},o.id);f.addEvent(n,"mouseout",function(){f.removeClass(s,m);},o.id);}if(l){f.addEvent(n,"mousedown",function(){f.addClass(s,l);},o.id);f.addEvent(g.body,"mouseup",function(){f.removeClass(s,l);},o.id);}}});b.bind("FilesRemoved",function(o,n){var l,m;for(l=0;l<n.length;l++){m=h("form_"+n[l].id);if(m){m.parentNode.removeChild(m);}}});b.bind("Destroy",function(p){var l,o,n,m={inputContainer:"form_"+d,inputFile:"input_"+d,browseButton:p.settings.browse_button};for(l in m){o=h(m[l]);if(o){f.removeAllEvents(o,p.id);}}f.removeAllEvents(g.body,p.id);f.each(G,function(q,r){n=h("form_"+q);if(n){E.removeChild(n);}});});J();});a({success:true});}});})(window,document,plupload);